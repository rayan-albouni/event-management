<div class="event-list-container">
  <header class="header">
    <h1>Event Management System</h1>
    <div class="header-actions">
      <span *ngIf="currentUser" class="user-info">
        Welcome, {{ currentUser.email }} ({{ currentUser.role }})
      </span>
      <button 
        *ngIf="isEventCreator()" 
        (click)="navigateToCreateEvent()"
        class="btn btn-primary">
        Create Event
      </button>
      <button (click)="logout()" class="btn btn-secondary">Logout</button>
    </div>
  </header>

  <div class="content">
    <h2>Available Events</h2>

    <div *ngIf="isLoading" class="loading">Loading events...</div>

    <div *ngIf="!isLoading && errorMessage" class="error-message">
      {{ errorMessage }}
    </div>

    <div *ngIf="!isLoading && events.length === 0" class="no-events">
      No events available at the moment.
    </div>

    <div class="events-grid" *ngIf="!isLoading && events.length > 0">
      <div *ngFor="let event of events" class="event-card">
        <h3>{{ event.name }}</h3>
        <p class="event-description">{{ event.description }}</p>
        
        <div class="event-details">
          <div class="detail-item">
            <strong>Location:</strong> {{ event.location }}
          </div>
          <div class="detail-item">
            <strong>Start:</strong> {{ formatDateTime(event.startTime) }}
          </div>
          <div class="detail-item">
            <strong>End:</strong> {{ formatDateTime(event.endTime) }}
          </div>
          <div class="detail-item">
            <strong>Registrations:</strong> {{ event.registrationCount }}
          </div>
        </div>

        <div class="event-actions">
          <!-- EventCreator buttons -->
          <div *ngIf="isEventCreator()" class="creator-actions">
            <button 
              (click)="modifyEvent(event)"
              class="btn btn-secondary">
              Modify
            </button>
            <button 
              (click)="deleteEvent(event)"
              class="btn btn-danger">
              Delete
            </button>
            <button 
              (click)="viewRegistrations(event)"
              class="btn btn-info">
              Registrations
            </button>
          </div>
          
          <!-- EventParticipant button -->
          <div *ngIf="isEventParticipant()" class="participant-actions">
            <button 
              (click)="openRegistrationModal(event)"
              class="btn btn-primary">
              Register
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Registration Modal -->
  <div *ngIf="showRegistrationModal" class="modal-overlay" (click)="closeRegistrationModal()">
    <div class="modal" (click)="$event.stopPropagation()">
      <h3>Register for {{ selectedEvent?.name }}</h3>
      
      <form (ngSubmit)="registerForEvent()" #registrationForm="ngForm">
        <div class="form-group">
          <label for="name">Full Name:</label>
          <input 
            type="text" 
            id="name" 
            name="name"
            [(ngModel)]="registrationData.name" 
            required 
            class="form-control">
        </div>

        <div class="form-group">
          <label for="email">Email:</label>
          <input 
            type="email" 
            id="email" 
            name="email"
            [(ngModel)]="registrationData.email" 
            required 
            email
            class="form-control">
        </div>

        <div class="form-group">
          <label for="phoneNumber">Phone Number:</label>
          <input 
            type="tel" 
            id="phoneNumber" 
            name="phoneNumber"
            [(ngModel)]="registrationData.phoneNumber" 
            required 
            class="form-control">
        </div>

        <div class="modal-actions">
          <button type="button" (click)="closeRegistrationModal()" class="btn btn-secondary">
            Cancel
          </button>
          <button 
            type="submit" 
            [disabled]="registrationForm.invalid"
            class="btn btn-primary">
            Register
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
